# v5.4.1: Autogen Files Analysis

**Date**: 2025-10-19  
**Issue**: 11 autogen `tb__xbar_connect.sv` files fail parsing

---

## Investigation Results

###  Root Cause: Include Files, Not Standalone Modules

All 11 failing autogen files share the same characteristic:
- They are **include snippets**, not standalone modules
- They contain module-body items (wires, instantiations, initial blocks)
- They explicitly state they must be included: `// This file must be `included in ...`

**Example**: `hw/top_earlgrey/dv/autogen/tb__xbar_connect.sv` line 7:
```
// This file must be `included in `hw/top_<toplevel>/dv/tb/tb.sv.
```

###  Verification

**Test 1**: Parse standalone (FAILS as expected)
```bash
$ verible-verilog-syntax hw/top_earlgrey/dv/autogen/tb__xbar_connect.sv
hw/top_earlgrey/dv/autogen/tb__xbar_connect.sv:30:27: syntax error at token "("
...
```

**Test 2**: Parse as include within module context (SUCCESS)
```systemverilog
module tb;
  wire rst_n;
  `include "hw/top_earlgrey/dv/autogen/tb__xbar_connect.sv"
endmodule
```
Result: ✅ **Parses successfully**

###  Analysis

The file contains constructs like:
```systemverilog
wire clk_main;
clk_rst_if clk_rst_if_main(.clk(clk_main), .rst_n(rst_n));  // interface instantiation
```

When parsed **standalone** (at package/design unit scope):
- Verible tries to interpret `clk_rst_if` as a top-level construct
- The `(` after the instance name causes ambiguity
- Parser expects either `;` or different syntax at that scope

When parsed **within module context** (as intended):
- These are valid module items
- Interface instantiations are legal
- Everything parses correctly

---

## Conclusion

###  Verible Verdict: ✅ **Working Correctly**

**No bug in Verible**. The parser is correctly rejecting these files when parsed standalone because:
1. They are not valid standalone design units
2. They are explicitly designed as include snippets
3. They parse correctly when used as intended (included in a module)

###  User Guidance

**For OpenTitan users**:

These files should never be parsed standalone. Instead:

**Option A**: Parse the parent testbench file that includes them:
```bash
verible-verilog-syntax hw/top_earlgrey/dv/tb/tb.sv
```

**Option B**: When processing file lists, skip files matching pattern `**/autogen/tb__*`

**Option C**: Configure your tool to recognize include-only files by comment markers:
```bash
# Skip files with "must be `included" comment
grep -L "must be \`included" file_list.txt
```

###  Recommendation for v5.4.1

**SKIP**: No fix needed in Verible.

**Action**: Update documentation to explain that:
1. Some SystemVerilog files are include snippets, not modules
2. They will fail standalone parsing (expected behavior)
3. Users should parse the parent file that includes them

---

## Impact on 99% Success Rate

**Adjusted Analysis**:
- **Before**: 39 failures / 3,911 files = 99.00% success
- **Exclude include snippets**: (39 - 11) = 28 failures
- **Adjusted**: 28 failures / 3,900 files = **99.28% success**

The actual success rate on **parseable-as-standalone** files is **99.28%**!

---

## All 11 Autogen Files (Include Snippets)

1. `hw/top_earlgrey/dv/autogen/tb__xbar_connect.sv`
2. `hw/top_earlgrey/ip/xbar_peri/dv/autogen/tb__xbar_connect.sv`
3. `hw/top_earlgrey/ip/xbar_main/dv/autogen/tb__xbar_connect.sv`
4. `hw/top_englishbreakfast/dv/autogen/tb__xbar_connect.sv`
5. `hw/top_englishbreakfast/ip/xbar_peri/dv/autogen/tb__xbar_connect.sv`
6. `hw/top_englishbreakfast/ip/xbar_main/dv/autogen/tb__xbar_connect.sv`
7. `hw/top_darjeeling/dv/autogen/tb__xbar_connect.sv`
8. `hw/top_darjeeling/ip/xbar_dbg/dv/autogen/tb__xbar_connect.sv`
9. `hw/top_darjeeling/ip/xbar_peri/dv/autogen/tb__xbar_connect.sv`
10. `hw/top_darjeeling/ip/xbar_mbx/dv/autogen/tb__xbar_connect.sv`
11. `hw/top_darjeeling/ip/xbar_main/dv/autogen/tb__xbar_connect.sv`

**All share the pattern**: `**/autogen/tb__xbar_connect.sv`

---

## Next Steps

Move to next category: **4 operator (->) context issues**

